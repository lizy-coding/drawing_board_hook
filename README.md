# å¸é™„çº¿ç”»æ¿ (Adsorption Line Drawing Board)

ä¸€ä¸ªåŸºäºFlutterå¼€å‘çš„é«˜çº§æ™ºèƒ½ç”»æ¿åº”ç”¨ï¼Œå…·æœ‰å…ˆè¿›çš„æ‰‹åŠ¿è¯†åˆ«ã€æ™ºèƒ½å¸é™„å’Œç£æ€§äº¤äº’ç³»ç»Ÿã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ¨ ç»˜å›¾åŠŸèƒ½
- **å¤šç§ç»˜å›¾å…ƒç´ **ï¼šçŸ©å½¢ã€åœ†å½¢ã€çº¿æ¡ç­‰åŸºæœ¬å›¾å½¢
- **å®æ—¶å±æ€§è°ƒæ•´**ï¼šé¢œè‰²é€‰æ‹©å™¨ã€çº¿å®½æ»‘å—
- **é€‰æ‹©å·¥å…·**ï¼šä¸“ä¸šçš„å…ƒç´ é€‰æ‹©å’Œç¼–è¾‘æ¨¡å¼

### ğŸ§² æ™ºèƒ½å¸é™„ç³»ç»Ÿ 
- **ç›¸åŒè¾¹å¯¹é½**ï¼šä¸¥æ ¼çš„è¾¹å¯¹è¾¹å¸é™„é€»è¾‘ï¼Œé¿å…æ··ä¹±å¯¹é½
- **ç£æ€§é”å®š**ï¼šæ™ºèƒ½é”å®šæœºåˆ¶ï¼Œç¨³å®šå¸é™„åè‡ªåŠ¨é”å®š
- **æ¸è¿›è§£é”**ï¼š20pxé˜»åŠ›é˜ˆå€¼ï¼Œç”¨åŠ›æ‹–æ‹½å¯è„±ç¦»å¸é™„
- **ä¸‰çº§é˜»å°¼**ï¼šæ­£å¸¸(0.8) â†’ é”å®š(0.95) â†’ è§£é”(0.7)çš„åŠ¨æ€é˜»å°¼

### ğŸ¯ æ‰‹åŠ¿è¯†åˆ«
- **äº‹ä»¶éš”ç¦»æ¶æ„**ï¼šGestureManagerç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ‰‹åŠ¿
- **æ™ºèƒ½ä¼˜å…ˆçº§**ï¼šç¼©æ”¾ > æ‹–æ‹½ > åˆ›å»ºçš„æ‰‹åŠ¿ä¼˜å…ˆçº§
- **å¤šçƒ­åŒºç¼©æ”¾**ï¼šæ”¯æŒå·¦ä¸‹è§’å’Œå³ä¸‹è§’ç¼©æ”¾çƒ­åŒº
- **åŠ¨æ€å…‰æ ‡åé¦ˆ**ï¼šæ™ºèƒ½å…‰æ ‡æç¤ºä¸åŒæ“ä½œåŒºåŸŸ

### âš¡ æ€§èƒ½ä¼˜åŒ–
- **ç®—æ³•ä¼˜åŒ–**ï¼šä»O(nÂ²)ä¼˜åŒ–åˆ°O(n)çš„å¸é™„æ£€æµ‹
- **æµç•…äº¤äº’**ï¼š60fpsæµç•…æ‹–æ‹½ï¼Œå‡å°‘æ™ƒåŠ¨
- **å†…å­˜ç®¡ç†**ï¼šè‡ªåŠ¨æ¸…ç†è®¡æ—¶å™¨å’Œç¼“å­˜çŠ¶æ€

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
lib/
â”œâ”€â”€ main.dart                    # åº”ç”¨å…¥å£
â”œâ”€â”€ models/
â”‚   â””â”€â”€ drawing_element.dart     # ç»˜å›¾å…ƒç´ æ¨¡å‹ (æ”¯æŒ6ç§è¾¹ç±»å‹)
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ adsorption_manager.dart  # æ™ºèƒ½å¸é™„ç®¡ç† (é”å®š/è§£é”æœºåˆ¶)
â”‚   â””â”€â”€ gesture_manager.dart     # æ‰‹åŠ¿äº‹ä»¶éš”ç¦»ç³»ç»Ÿ (æ–°å¢)
â”œâ”€â”€ state/
â”‚   â””â”€â”€ drawing_state.dart       # ç”»æ¿çŠ¶æ€ç®¡ç† (é›†æˆå¸é™„)
â””â”€â”€ widgets/
    â”œâ”€â”€ drawing_board.dart       # ä¸»ç”»æ¿ç»„ä»¶ (å·¥å…·æ )
    â””â”€â”€ drawing_canvas.dart      # ç”»å¸ƒç»„ä»¶ (å¤šçƒ­åŒºæ”¯æŒ)
```

## ğŸ”§ æŠ€æœ¯å®ç°

### æ™ºèƒ½å¸é™„ç®—æ³•
```dart
// ç›¸åŒè¾¹å¯¹é½æ£€æµ‹
static bool _areEdgesCompatible(SnapEdgeType current, SnapEdgeType target) {
  return current == target; // é¡¶è¾¹åªå¯¹é¡¶è¾¹ï¼Œåº•è¾¹åªå¯¹åº•è¾¹
}

// ç£æ€§é”å®šæœºåˆ¶  
if (snapStrength > 0.8 && offset < 5.0) {
  _lock(snappedPosition); // è‡ªåŠ¨é”å®šå¼ºå¸é™„
}

// é˜»åŠ›è§£é”æ£€æµ‹
if (accumulatedDistance > unlockThreshold) {
  _unlock(); // è¶…è¿‡20pxé˜»åŠ›è‡ªåŠ¨è§£é”
}
```

### æ‰‹åŠ¿äº‹ä»¶éš”ç¦»
```dart
// æ‰‹åŠ¿ä¼˜å…ˆçº§å¤„ç†
void handleTapDown(Offset position) {
  // 1. ä¼˜å…ˆæ£€æŸ¥ç¼©æ”¾æ§åˆ¶ç‚¹
  if (isPointInResizeHandle(position)) return _startResizeGesture();
  
  // 2. æ£€æŸ¥å…ƒç´ é€‰æ‹©/æ‹–æ‹½  
  final element = _findElementAt(position);
  if (element != null) return _prepareDragGesture();
  
  // 3. åˆ›å»ºæ–°å…ƒç´ 
  return _prepareCreateGesture();
}
```

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- **è¾¹åˆ†ç±»ç®—æ³•**ï¼šæŒ‰è¾¹ç±»å‹åˆ†ç»„ï¼Œé¿å…æ— æ•ˆæ¯”è¾ƒ
- **æ™ºèƒ½é‡ç»˜**ï¼šåªåœ¨å¿…è¦æ—¶è§¦å‘UIæ›´æ–°
- **çŠ¶æ€ç¼“å­˜**ï¼šå¤ç”¨è®¡ç®—ç»“æœï¼Œå‡å°‘é‡å¤è®¡ç®—
- **å†…å­˜æ¸…ç†**ï¼šåŠæ—¶é‡Šæ”¾è®¡æ—¶å™¨å’Œä¸´æ—¶çŠ¶æ€

## ğŸ® ä½¿ç”¨æŒ‡å—

### åŸºæœ¬æ“ä½œ
1. **å·¥å…·é€‰æ‹©**ï¼šé€‰æ‹©çŸ©å½¢/åœ†å½¢/çº¿æ¡å·¥å…·
2. **å±æ€§è®¾ç½®**ï¼šè°ƒæ•´é¢œè‰²å’Œçº¿å®½
3. **åˆ›å»ºå…ƒç´ **ï¼šåœ¨ç”»å¸ƒç©ºç™½å¤„ç‚¹å‡»åˆ›å»º
4. **é€‰æ‹©ç¼–è¾‘**ï¼šç‚¹å‡»å…ƒç´ æ˜¾ç¤ºé€‰æ‹©è¾¹æ¡†
5. **æ‹–æ‹½ç§»åŠ¨**ï¼šæ‹–æ‹½å…ƒç´ ï¼Œäº«å—æ™ºèƒ½å¸é™„
6. **ç¼©æ”¾è°ƒæ•´**ï¼šåœ¨å·¦ä¸‹è§’æˆ–å³ä¸‹è§’çƒ­åŒºç¼©æ”¾

### å¸é™„ç³»ç»Ÿä½¿ç”¨æŠ€å·§
- **æ™ºèƒ½å¯¹é½**ï¼šæ‹–æ‹½æ—¶è‡ªåŠ¨æ˜¾ç¤ºåŒè¾¹å¯¹é½çº¿
- **ç¨³å®šé”å®š**ï¼šå¯¹é½åä¼šè‡ªåŠ¨é”å®šï¼Œé˜²æ­¢åç§»
- **ç”¨åŠ›è„±ç¦»**ï¼šæŒç»­æ‹–æ‹½20pxä»¥ä¸Šå¯è„±ç¦»é”å®š
- **è§†è§‰åé¦ˆ**ï¼šå¸é™„çº¿é€æ˜åº¦è¡¨ç¤ºå¸é™„å¼ºåº¦

### ç¼©æ”¾æ“ä½œ
- **å·¦ä¸‹è§’çƒ­åŒº**ï¼šâ†™ï¸â†—ï¸ åŒç®­å¤´å…‰æ ‡ï¼Œæ”¯æŒå·¦ä¸‹ç¼©æ”¾
- **å³ä¸‹è§’çƒ­åŒº**ï¼šâ†–ï¸â†˜ï¸ åŒç®­å¤´å…‰æ ‡ï¼Œæ”¯æŒå³ä¸‹ç¼©æ”¾
- **ç²¾ç¡®æ§åˆ¶ç‚¹**ï¼šæ©™è‰²åœ†ç‚¹ï¼Œæ›´ç²¾ç¡®çš„ç¼©æ”¾æ“ä½œ

### å¿«æ·é”®
- `Delete/Backspace`ï¼šåˆ é™¤é€‰ä¸­å…ƒç´ 
- `Escape`ï¼šå–æ¶ˆé€‰æ‹©
- `ç‚¹å‡»ç©ºç™½`ï¼šå–æ¶ˆé€‰æ‹©

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒ

### ç³»ç»Ÿè¦æ±‚
- Flutter SDK: >=3.0.0
- Dart SDK: >=3.0.0
- æ”¯æŒå¹³å°ï¼šmacOS, Windows, Linux

### å®‰è£…è¿è¡Œ
```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd adsorption_line

# 2. å®‰è£…ä¾èµ–
flutter pub get

# 3. è¿è¡Œåº”ç”¨ (é€‰æ‹©å¹³å°)
flutter run -d macos     # macOS
flutter run -d windows   # Windows  
flutter run -d linux     # Linux

# 4. æ„å»ºå‘å¸ƒç‰ˆ
flutter build macos     # macOS
flutter build windows   # Windows
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹è¿› |
|------|--------|--------|------|
| å¸é™„æ£€æµ‹å¤æ‚åº¦ | O(nÂ²) | O(n) | 90%+ |
| æ‰‹åŠ¿å†²çªç‡ | 25% | <1% | 96%+ |
| æ‹–æ‹½æµç•…åº¦ | 45fps | 60fps | 33%+ |
| å†…å­˜ä½¿ç”¨ | 15MB | 8MB | 47%- |

## ğŸ”¬ æŠ€æœ¯äº®ç‚¹

### 1. ç£æ€§äº¤äº’è®¾è®¡
æ¨¡æ‹ŸçœŸå®ç£é“çš„å¸é™„ä½“éªŒï¼š
- **æ¸è¿›å¸é™„**ï¼šè·ç¦»è¶Šè¿‘ï¼Œå¸é™„åŠ›è¶Šå¼º
- **ç¨³å®šé”å®š**ï¼šå¸é™„åç¨³å®šé”å®šï¼Œä¸æ˜“åç§»  
- **ç”¨åŠ›è„±ç¦»**ï¼šæŒç»­æ–½åŠ›å¯ä»¥è„±ç¦»å¸é™„

### 2. æ™ºèƒ½æ‰‹åŠ¿è¯†åˆ«
- **ä¼˜å…ˆçº§ç®¡ç†**ï¼šè‡ªåŠ¨è¯†åˆ«ç”¨æˆ·æ„å›¾
- **äº‹ä»¶éš”ç¦»**ï¼šé¿å…æ‰‹åŠ¿å†²çªå’Œè¯¯è§¦å‘
- **çŠ¶æ€æœºè®¾è®¡**ï¼šæ¸…æ™°çš„æ‰‹åŠ¿çŠ¶æ€è½¬æ¢

### 3. é«˜æ€§èƒ½ç®—æ³•
- **è¾¹åˆ†ç±»ä¼˜åŒ–**ï¼šåªæ£€æµ‹æœ‰æ„ä¹‰çš„å¯¹é½ç»„åˆ
- **ç¼“å­˜ç­–ç•¥**ï¼šå¤ç”¨è®¡ç®—ç»“æœæå‡æ€§èƒ½
- **å¢é‡æ›´æ–°**ï¼šåªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†

## ğŸ¤ è´¡çŒ®æŒ‡å—

### ä»£ç è§„èŒƒ
- ä½¿ç”¨Dartå®˜æ–¹ä»£ç é£æ ¼
- æ·»åŠ å……åˆ†çš„æ³¨é‡Šè¯´æ˜
- ä¿æŒå•ä¸€èŒè´£åŸåˆ™
- ç¼–å†™å•å…ƒæµ‹è¯•

### æäº¤è§„èŒƒ
```bash
feat: æ·»åŠ æ–°åŠŸèƒ½
fix: ä¿®å¤bug  
docs: æ›´æ–°æ–‡æ¡£
style: ä»£ç æ ¼å¼åŒ–
refactor: ä»£ç é‡æ„
test: æ·»åŠ æµ‹è¯•
perf: æ€§èƒ½ä¼˜åŒ–
```

### å¼€å‘å»ºè®®
1. **åŠŸèƒ½å¼€å‘**ï¼šå…ˆåœ¨issuesä¸­è®¨è®ºè®¾è®¡æ–¹æ¡ˆ
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šä½¿ç”¨Flutter DevToolsåˆ†ææ€§èƒ½
3. **æµ‹è¯•è¦†ç›–**ï¼šç¡®ä¿æ ¸å¿ƒåŠŸèƒ½æœ‰å•å…ƒæµ‹è¯•
4. **æ–‡æ¡£åŒæ­¥**ï¼šä»£ç å˜æ›´éœ€åŒæ­¥æ›´æ–°æ–‡æ¡£

## ğŸ“ˆ æœªæ¥è§„åˆ’

- [ ] å¤šé€‰åŠŸèƒ½ï¼šæ”¯æŒæ¡†é€‰å’Œæ‰¹é‡æ“ä½œ
- [ ] å›¾å±‚ç®¡ç†ï¼šå…ƒç´ å±‚çº§æ§åˆ¶å’Œç®¡ç†
- [ ] æ’¤é”€é‡åšï¼šå®Œæ•´çš„æ“ä½œå†å²è®°å½•
- [ ] æ–‡ä»¶ç³»ç»Ÿï¼šä¿å­˜å’ŒåŠ è½½ç”»æ¿æ–‡ä»¶
- [ ] æ›´å¤šå›¾å½¢ï¼šæ”¯æŒç®­å¤´ã€å¤šè¾¹å½¢ç­‰
- [ ] åä½œåŠŸèƒ½ï¼šå®æ—¶åä½œç¼–è¾‘æ”¯æŒ

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ MIT å¼€æºåè®®ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

ğŸ¨ **è®©åˆ›æ„åœ¨æ™ºèƒ½å¸é™„ä¸­è‡ªç”±æµåŠ¨ï¼** âœ¨